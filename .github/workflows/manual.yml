# This is a basic workflow that is manually triggered

name: Manual workflow

# Controls when the action will run. Workflow runs when manually triggered using the UI
# or API.
on:
  workflow_dispatch:
    # Inputs the workflow accepts.
    inputs:
      name:
        # Friendly description to be shown in the UI instead of 'name'
        description: 'Person to greet'
        # Default value if no value is explicitly provided
        default: 'World'
        # Input has to be provided for the workflow to run
        required: true

jobs:
  get_tags:
    runs-on: ubuntu-20.04
    steps:
      - name: Get Latest Tags
        run: echo ::set-output name=VERSION::${GITHUB_REF/refs\/tags\//}
      - name: test
        env:
          TAG_NAME: ${{ steps.get_tags.outputs.VERSION }}
        run: echo "$TAG_NAME"
#  Prep-Environmnet:
#    runs-on: ubuntu-20.04
#    steps:
#      - name: Prep Environmnet
#      - uses: actions/checkout@v2
#      - uses: actions/setup-go@v2.1.3
#        with:
#          go-version: '^1.16'
#      - name: Replace yaml with secrets
#        env:
#          wp_db_user: ${{ secrets.WP_DB_USER }}
#          wp_db_pass: ${{ secrets.WP_DB_PASS }}
#          adguard_ip: ${{ secrets.ADGUARD_IP }}
#          cachet_db_user: ${{ secrets.CACHET_DB_USER }}
#          cachet_db_pass: ${{ secrets.CACHET_DB_PASS }}
#          phonito_api: ${{ secrets.PHONITO_API }}
#        run: |
#          go run main.go
  Deploy-Adguard:
    runs-on: ubuntu-20.04
    steps:
      - name: test
        env:
          TAG_NAME: ${{ steps.get_tags.outputs.VERSION }}
        run: echo "$TAG_NAME"
#    runs-on: ubuntu-20.04
#    needs: Prep-Environmnet
#    steps:
#      - name: Deploy Adguard
#      uses: actions-hub/kubectl@master
#        env:
#          KUBE_CONFIG: ${{ secrets.KUBE_CONFIG }}
#          KUBECTL_VERSION: "1.20"
#        with:
#          args: apply -k ./Deployments/adguard
